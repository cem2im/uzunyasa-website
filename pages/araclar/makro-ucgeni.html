<!DOCTYPE html>
<html lang="tr">
<head>
<link rel="icon" type="image/png" sizes="32x32" href="/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16.png">
<script src="/scripts/https-redirect.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QBM7E0EHFP"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 gtag('config', 'G-QBM7E0EHFP');
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Makro ÃœÃ§geni â€” Besin Makro Tahmin Oyunu | UzunYaÅŸa</title>
<meta name="description" content="100 TÃ¼rk yemeÄŸinin protein, yaÄŸ ve karbonhidrat oranlarÄ±nÄ± tahmin et! EÄŸlenceli makro besin testi ile beslenme bilgini sÄ±na.">
<link rel="canonical" href="https://uzunyasa.com/pages/araclar/makro-ucgeni.html">
<meta property="og:title" content="Makro ÃœÃ§geni â€” Besin Makro Tahmin Oyunu | UzunYaÅŸa">
<meta property="og:description" content="100 TÃ¼rk yemeÄŸinin makro oranlarÄ±nÄ± tahmin et! EÄŸlenceli beslenme testi.">
<meta property="og:image" content="https://uzunyasa.com/images/og-default.png">
<meta property="og:url" content="https://uzunyasa.com/pages/araclar/makro-ucgeni.html">
<meta property="og:type" content="website">
<meta property="og:locale" content="tr_TR">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<style>
:root{--primary:#0D7377;--dark:#195157;--accent:#E8963E;--protein:#E8963E;--fat:#dc2626;--carb:#2D9F4F;--bg:#f8fafa;--card:#fff;--gray-50:#f9fafb;--gray-100:#f3f4f6;--gray-200:#e5e7eb;--gray-400:#9ca3af;--gray-500:#6b7280;--gray-700:#374151;--gray-900:#111827;--radius:16px;--shadow:0 4px 24px rgba(0,0,0,.08)}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--gray-700);line-height:1.6;min-height:100vh;display:flex;flex-direction:column}
.playfair{font-family:'Playfair Display',serif}

/* Header */
.site-header{background:#fff;border-bottom:1px solid var(--gray-200);padding:.875rem 1.5rem;position:sticky;top:0;z-index:100;display:flex;align-items:center;justify-content:space-between}
.site-header a{text-decoration:none;display:flex;align-items:center;gap:.5rem}
.logo-text{font-family:'Playfair Display',serif;font-size:1.35rem;font-weight:700;color:var(--dark)}
.logo-text span{color:var(--accent)}
.back-link{font-size:.875rem;color:var(--primary);font-weight:600;text-decoration:none;display:flex;align-items:center;gap:.25rem}

/* Main container */
.game-wrap{max-width:640px;margin:0 auto;padding:1rem;width:100%;flex:1}

/* Progress */
.progress-bar{background:var(--gray-200);border-radius:99px;height:8px;margin-bottom:.5rem;overflow:hidden}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:99px;transition:width .4s ease}
.progress-text{font-size:.8rem;color:var(--gray-500);text-align:center;margin-bottom:1rem}

/* Score bar */
.score-bar{display:flex;justify-content:center;gap:1.5rem;margin-bottom:1rem;font-size:.85rem;font-weight:600}
.score-bar .item{display:flex;align-items:center;gap:.35rem}
.score-bar .icon{font-size:1.1rem}

/* Card */
.card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden;margin-bottom:1rem}
.food-img-wrap{position:relative;width:100%;aspect-ratio:16/10;overflow:hidden;background:var(--gray-100)}
.food-img-wrap img{width:100%;height:100%;object-fit:cover;transition:transform .3s}
.food-img-wrap img:hover{transform:scale(1.03)}
.food-badge{position:absolute;top:.75rem;left:.75rem;background:rgba(0,0,0,.6);color:#fff;padding:.3rem .75rem;border-radius:99px;font-size:.75rem;font-weight:600;backdrop-filter:blur(4px)}
.food-info{padding:1.25rem 1.5rem .75rem}
.food-name{font-family:'Playfair Display',serif;font-size:1.5rem;font-weight:700;color:var(--dark);margin-bottom:.25rem}
.food-portion{font-size:.85rem;color:var(--gray-500)}

/* Triangle area */
.triangle-section{padding:1rem 1.5rem}
.triangle-container{position:relative;width:100%;max-width:360px;margin:0 auto}
.triangle-svg{width:100%;height:auto;display:block;cursor:crosshair;touch-action:none;user-select:none}

/* Sliders */
.sliders{padding:0 1.5rem 1rem}
.slider-row{display:flex;align-items:center;gap:.75rem;margin-bottom:.65rem}
.slider-label{width:80px;font-size:.8rem;font-weight:700;display:flex;align-items:center;gap:.35rem}
.slider-dot{width:10px;height:10px;border-radius:50%;flex-shrink:0}
.slider-row input[type=range]{flex:1;height:6px;-webkit-appearance:none;appearance:none;border-radius:99px;outline:none;cursor:pointer}
.slider-row input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:22px;height:22px;border-radius:50%;border:3px solid #fff;box-shadow:0 1px 4px rgba(0,0,0,.2);cursor:grab}
.slider-row input[type=range]::-moz-range-thumb{width:22px;height:22px;border-radius:50%;border:3px solid #fff;box-shadow:0 1px 4px rgba(0,0,0,.2);cursor:grab}
.slider-val{width:42px;text-align:right;font-size:.95rem;font-weight:700;font-variant-numeric:tabular-nums}
.s-protein input{background:linear-gradient(90deg,#fef3c7,var(--protein))}.s-protein input::-webkit-slider-thumb{background:var(--protein)}.s-protein input::-moz-range-thumb{background:var(--protein)}.s-protein .slider-val{color:var(--protein)}
.s-fat input{background:linear-gradient(90deg,#fee2e2,var(--fat))}.s-fat input::-webkit-slider-thumb{background:var(--fat)}.s-fat input::-moz-range-thumb{background:var(--fat)}.s-fat .slider-val{color:var(--fat)}
.s-carb input{background:linear-gradient(90deg,#d1fae5,var(--carb))}.s-carb input::-webkit-slider-thumb{background:var(--carb)}.s-carb input::-moz-range-thumb{background:var(--carb)}.s-carb .slider-val{color:var(--carb)}

/* Buttons */
.btn-area{padding:0 1.5rem 1.5rem;text-align:center}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.9rem 2.5rem;border-radius:99px;border:none;font-size:1rem;font-weight:700;cursor:pointer;transition:all .2s;font-family:inherit}
.btn-primary{background:var(--primary);color:#fff}.btn-primary:hover{background:var(--dark);transform:translateY(-1px)}
.btn-accent{background:var(--accent);color:#fff}.btn-accent:hover{filter:brightness(1.1);transform:translateY(-1px)}
.btn-outline{background:transparent;border:2px solid var(--primary);color:var(--primary)}.btn-outline:hover{background:var(--primary);color:#fff}

/* Result overlay */
.result-overlay{display:none;padding:1rem 1.5rem 1.5rem}
.result-overlay.show{display:block}
.result-grid{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-bottom:1rem}
.result-col{text-align:center;padding:.75rem;border-radius:12px;background:var(--gray-50)}
.result-col h4{font-size:.7rem;text-transform:uppercase;letter-spacing:.5px;color:var(--gray-500);margin-bottom:.5rem}
.result-col .vals{display:flex;flex-direction:column;gap:.25rem}
.result-col .val-row{display:flex;justify-content:space-between;font-size:.85rem}
.result-col .val-row .dot{width:8px;height:8px;border-radius:50%;margin-right:.35rem;flex-shrink:0;margin-top:5px}
.score-reveal{text-align:center;margin-bottom:1rem}
.score-big{font-size:3rem;font-weight:900;line-height:1}
.score-label{font-size:.85rem;color:var(--gray-500);margin-top:.25rem}
.fun-fact{background:linear-gradient(135deg,#f0fdfa,#ecfdf5);border-left:4px solid var(--carb);padding:1rem;border-radius:0 12px 12px 0;font-size:.85rem;margin-bottom:1rem;color:var(--dark)}
.fun-fact strong{color:var(--carb)}

/* Category filter */
.cat-filter{display:flex;gap:.5rem;overflow-x:auto;padding-bottom:.5rem;margin-bottom:1rem;-webkit-overflow-scrolling:touch}
.cat-filter::-webkit-scrollbar{display:none}
.cat-btn{padding:.5rem 1rem;border-radius:99px;border:2px solid var(--gray-200);background:#fff;color:var(--gray-500);font-size:.8rem;font-weight:600;cursor:pointer;white-space:nowrap;transition:all .2s;font-family:inherit}
.cat-btn:hover,.cat-btn.active{border-color:var(--primary);color:var(--primary)}
.cat-btn.active{background:var(--primary);color:#fff}

/* Start / End screens */
.screen{display:none;text-align:center;padding:3rem 1.5rem}
.screen.active{display:block}
.screen h1{font-family:'Playfair Display',serif;font-size:2.2rem;color:var(--dark);margin-bottom:.75rem}
.screen p{color:var(--gray-500);margin-bottom:1.5rem;max-width:420px;margin-left:auto;margin-right:auto}
.end-score{font-size:5rem;font-weight:900;background:linear-gradient(135deg,var(--primary),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;line-height:1;margin-bottom:.25rem}
.end-max{font-size:1rem;color:var(--gray-400);margin-bottom:1.5rem}
.streak-badge{display:inline-flex;align-items:center;gap:.35rem;background:#fef3c7;color:#92400e;padding:.4rem 1rem;border-radius:99px;font-size:.85rem;font-weight:600;margin-bottom:1.5rem}
.share-box{background:var(--gray-50);border-radius:12px;padding:1rem;margin:1rem 0;font-size:.85rem;color:var(--gray-700)}
.share-box button{margin-top:.5rem}

/* Game screen */
#gameScreen{display:none}
#gameScreen.active{display:block}

/* Footer */
.site-footer{background:var(--dark);color:rgba(255,255,255,.7);text-align:center;padding:2rem 1.5rem;font-size:.8rem;margin-top:auto}
.site-footer a{color:var(--accent);text-decoration:none}

/* Responsive */
@media(max-width:480px){
 .food-name{font-size:1.25rem}
 .triangle-container{max-width:300px}
 .result-grid{grid-template-columns:1fr}
 .score-big{font-size:2.5rem}
 .screen h1{font-size:1.75rem}
 .end-score{font-size:3.5rem}
}

/* Animation */
@keyframes pop{0%{transform:scale(0)}50%{transform:scale(1.2)}100%{transform:scale(1)}}
.pop{animation:pop .4s ease}
@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
.slide-up{animation:slideUp .4s ease}
</style>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "Makro ÃœÃ§geni â€” Besin Makro Tahmin Oyunu | UzunYaÅŸa",
  "description": "100 TÃ¼rk yemeÄŸinin protein, yaÄŸ ve karbonhidrat oranlarÄ±nÄ± tahmin et! EÄŸlenceli makro besin testi ile beslenme bilgini sÄ±na.",
  "url": "https://uzunyasa.com/pages/araclar/makro-ucgeni.html",
  "applicationCategory": "HealthApplication",
  "operatingSystem": "Web",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "TRY"
  },
  "author": {
    "@type": "Organization",
    "name": "UzunYaÅŸa",
    "url": "https://uzunyasa.com"
  },
  "image": "https://uzunyasa.com/images/og-default.png"
}
</script>
</head>
<body>

<header class="site-header">
 <a href="/index.html">
  <span class="logo-text">Uzun<span>YaÅŸa</span></span>
 </a>
 <a href="/pages/araclar.html" class="back-link">â† AraÃ§lar</a>
</header>

<!-- START SCREEN -->
<div class="game-wrap">
<div id="startScreen" class="screen active">
 <div style="font-size:4rem;margin-bottom:1rem">ğŸ”º</div>
 <h1>Makro ÃœÃ§geni</h1>
 <p>TÃ¼rk mutfaÄŸÄ±nÄ±n en sevilen 100 yemeÄŸinin protein, yaÄŸ ve karbonhidrat oranlarÄ±nÄ± ne kadar iyi biliyorsun? 10 yemek, 10 tahmin â€” hadi baÅŸlayalÄ±m!</p>

 <div class="cat-filter" id="catFilter" style="justify-content:center;flex-wrap:wrap;margin-bottom:1.5rem">
  <button class="cat-btn active" data-cat="all">ğŸ² KarÄ±ÅŸÄ±k</button>
  <button class="cat-btn" data-cat="corba">ğŸ² Ã‡orbalar</button>
  <button class="cat-btn" data-cat="et">ğŸ¥© Et Yemekleri</button>
  <button class="cat-btn" data-cat="sebze">ğŸ¥¬ Sebze</button>
  <button class="cat-btn" data-cat="tatli">ğŸ° TatlÄ±lar</button>
  <button class="cat-btn" data-cat="atistirmalik">ğŸ¥™ AtÄ±ÅŸtÄ±rmalÄ±klar</button>
  <button class="cat-btn" data-cat="icecek">ğŸ¥¤ Ä°Ã§ecekler</button>
 </div>

 <button class="btn btn-primary" onclick="startGame()" style="font-size:1.1rem;padding:1rem 3rem">ğŸ¯ Oyunu BaÅŸlat</button>
</div>

<!-- GAME SCREEN -->
<div id="gameScreen">
 <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
 <div class="progress-text" id="progressText">1 / 10</div>

 <div class="score-bar">
  <div class="item"><span class="icon">ğŸ†</span> <span id="totalScore">0</span> puan</div>
  <div class="item"><span class="icon">ğŸ”¥</span> <span id="streak">0</span> seri</div>
 </div>

 <div class="card" id="foodCard">
  <div class="food-img-wrap">
   <img id="foodImg" src="" alt="" loading="eager">
   <div class="food-badge" id="foodCategory"></div>
  </div>
  <div class="food-info">
   <div class="food-name" id="foodName"></div>
   <div class="food-portion" id="foodPortion">100g baÅŸÄ±na</div>
  </div>

  <div class="triangle-section">
   <div class="triangle-container" id="triContainer">
    <svg id="triSvg" viewBox="0 0 400 370" class="triangle-svg">
     <!-- Grid lines -->
     <defs>
      <linearGradient id="gProt" x1="0%" y1="100%" x2="50%" y2="0%"><stop offset="0%" stop-color="#f3f4f6"/><stop offset="100%" stop-color="rgba(232,150,62,.15)"/></linearGradient>
      <linearGradient id="gFat" x1="100%" y1="100%" x2="0%" y2="100%"><stop offset="0%" stop-color="#f3f4f6"/><stop offset="100%" stop-color="rgba(220,38,38,.15)"/></linearGradient>
      <linearGradient id="gCarb" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#f3f4f6"/><stop offset="100%" stop-color="rgba(45,159,79,.15)"/></linearGradient>
     </defs>
     <!-- Triangle fill -->
     <polygon points="200,20 30,330 370,330" fill="#f9fafb" stroke="var(--gray-200)" stroke-width="2"/>
     <!-- Grid -->
     <g stroke="var(--gray-200)" stroke-width="0.5" opacity="0.6" id="triGrid"></g>
     <!-- Corner labels -->
     <text x="200" y="12" text-anchor="middle" font-size="13" font-weight="700" fill="var(--protein)">Protein</text>
     <text x="15" y="352" text-anchor="start" font-size="13" font-weight="700" fill="var(--fat)">YaÄŸ</text>
     <text x="385" y="352" text-anchor="end" font-size="13" font-weight="700" fill="var(--carb)">Karbonhidrat</text>
     <!-- Guess dot -->
     <circle id="guessDot" cx="200" cy="227" r="10" fill="var(--primary)" stroke="#fff" stroke-width="3" style="filter:drop-shadow(0 2px 4px rgba(0,0,0,.2));transition:cx .3s,cy .3s"/>
     <!-- Answer dot (hidden initially) -->
     <circle id="answerDot" cx="200" cy="227" r="10" fill="var(--accent)" stroke="#fff" stroke-width="3" style="filter:drop-shadow(0 2px 4px rgba(0,0,0,.3));opacity:0;transition:all .6s ease"/>
     <!-- Line between guess and answer -->
     <line id="diffLine" x1="0" y1="0" x2="0" y2="0" stroke="var(--gray-400)" stroke-width="1.5" stroke-dasharray="4" opacity="0" style="transition:opacity .4s"/>
    </svg>
   </div>
  </div>

  <div class="sliders" id="slidersArea">
   <div class="slider-row s-protein">
    <div class="slider-label"><div class="slider-dot" style="background:var(--protein)"></div>Protein</div>
    <input type="range" min="0" max="100" value="33" id="sProtein">
    <div class="slider-val" id="vProtein">33%</div>
   </div>
   <div class="slider-row s-fat">
    <div class="slider-label"><div class="slider-dot" style="background:var(--fat)"></div>YaÄŸ</div>
    <input type="range" min="0" max="100" value="34" id="sFat">
    <div class="slider-val" id="vFat">34%</div>
   </div>
   <div class="slider-row s-carb">
    <div class="slider-label"><div class="slider-dot" style="background:var(--carb)"></div>Karbonhidrat</div>
    <input type="range" min="0" max="100" value="33" id="sCarb">
    <div class="slider-val" id="vCarb">33%</div>
   </div>
  </div>

  <div class="btn-area" id="guessArea">
   <button class="btn btn-primary" id="guessBtn" onclick="revealAnswer()">ğŸ¯ Tahmin Et</button>
  </div>

  <div class="result-overlay" id="resultOverlay">
   <div class="score-reveal slide-up">
    <div class="score-big" id="roundScore" style="color:var(--primary)">0</div>
    <div class="score-label">puan (100 Ã¼zerinden)</div>
   </div>
   <div class="result-grid slide-up">
    <div class="result-col">
     <h4>Senin Tahminin</h4>
     <div class="vals" id="guessVals"></div>
    </div>
    <div class="result-col">
     <h4>GerÃ§ek DeÄŸerler</h4>
     <div class="vals" id="realVals"></div>
    </div>
   </div>
   <div class="fun-fact slide-up" id="funFact"></div>
   <div class="btn-area">
    <button class="btn btn-accent" id="nextBtn" onclick="nextFood()">Sonraki â†’</button>
   </div>
  </div>
 </div>
</div>

<!-- END SCREEN -->
<div id="endScreen" class="screen">
 <div style="font-size:3rem;margin-bottom:.5rem">ğŸ†</div>
 <h1>Tebrikler!</h1>
 <div class="end-score" id="finalScore">0</div>
 <div class="end-max">/ 1000 puan</div>
 <div class="streak-badge" id="finalStreak">ğŸ”¥ En uzun seri: 0</div>
 <p id="endMsg"></p>
 <div class="share-box">
  <div id="shareText"></div>
  <button class="btn btn-primary" onclick="shareResult()" style="font-size:.85rem;padding:.6rem 1.5rem">ğŸ“‹ Kopyala & PaylaÅŸ</button>
 </div>
 <div style="margin-top:1.5rem;display:flex;gap:.75rem;justify-content:center;flex-wrap:wrap">
  <button class="btn btn-accent" onclick="startGame()">ğŸ”„ Tekrar Oyna</button>
  <a href="/pages/araclar.html" class="btn btn-outline">â† DiÄŸer AraÃ§lar</a>
 </div>
</div>
</div>

<footer class="site-footer">
 <p>Â© 2025 UzunYaÅŸa â€” SaÄŸlÄ±klÄ± yaÅŸam rehberiniz</p>
 <p style="margin-top:.5rem"><a href="/pages/gizlilik-politikasi.html">Gizlilik</a> Â· <a href="/pages/kullanim-sartlari.html">KullanÄ±m ÅartlarÄ±</a> Â· <a href="/pages/hakkimizda.html">HakkÄ±mÄ±zda</a></p>
</footer>

<script>
// â”€â”€ FOOD DATA (100 Turkish foods, macros per 100g as percentages of total macro calories) â”€â”€
// Format: [name, protein%, fat%, carb%, category, photoId, funFact, cal/100g]
// Macros are percentage of CALORIES from each macro (protein+fat+carb = 100)
const FOODS = [
["Lahmacun",14,30,56,"atistirmalik","1543793674-b1bbf2a99c22","Lahmacun aslÄ±nda ince hamur sayesinde birÃ§ok pideden daha dÃ¼ÅŸÃ¼k kalorilidir.",265],
["DÃ¶ner (Tavuk)",52,35,13,"et","1529006557810-9dee9befa23f","Tavuk dÃ¶ner, protein aÃ§Ä±sÄ±ndan en zengin TÃ¼rk fast food'larÄ±ndan biridir.",175],
["Kuru Fasulye",24,8,68,"sebze","1536304993664-32a9ebb56789","Kuru fasulye hem protein hem lif deposudur â€” 100g'da 7g lif bulunur.",120],
["Mercimek Ã‡orbasÄ±",20,22,58,"corba","1547592166-0471c2609de2","Mercimek Ã§orbasÄ± limon ile servis edilir Ã§Ã¼nkÃ¼ C vitamini demir emilimini artÄ±rÄ±r.",85],
["BÃ¶rek (Peynirli)",14,42,44,"atistirmalik","1519864600265-abb23847ef2c","Su bÃ¶reÄŸi geleneÄŸi OsmanlÄ± saray mutfaÄŸÄ±na dayanÄ±r.",280],
["Baklava",5,40,55,"tatli","1519676867240-f03562e64548","Bir dilim baklavada yaklaÅŸÄ±k 25 kat yufka bulunur.",430],
["KÃ¼nefe",6,38,56,"tatli","1590080875515-8a3a8dc5735e","KÃ¼nefenin ana peyniri, tuzlu dil peyniridir. Tel kadayÄ±f ile sarÄ±lÄ±r.",350],
["MantÄ±",18,30,52,"et","1625938145744-e3fe45b4b5d5","Kayseri mantÄ±sÄ± ne kadar kÃ¼Ã§Ã¼kse, yapanÄ±n eli o kadar becerikli sayÄ±lÄ±r.",190],
["KÃ¶fte (Izgara)",48,42,10,"et","1529042355636-9d2a2d3e3894","Ä°zgara kÃ¶ftenin dÃ¼ÅŸÃ¼k karbonhidrat oranÄ± onu keto diyetine uygun kÄ±lar.",215],
["Pilav (PirinÃ§)",8,5,87,"sebze","1516684732162-798a0062be99","PirinÃ§ pilavÄ± TÃ¼rk mutfaÄŸÄ±nÄ±n olmazsa olmazÄ±dÄ±r â€” hemen her yemeÄŸin yanÄ±nda gelir.",130],
["Sarma (Yaprak)",10,35,55,"sebze","1625398407800-0a848e480c41","ZeytinyaÄŸlÄ± yaprak sarma, Ege mutfaÄŸÄ±nÄ±n sembol yemeklerinden biridir.",155],
["Dolma (Biber)",12,30,58,"sebze","1600891964092-4316c8e21d2a","Dolma kelimesi TÃ¼rkÃ§e 'doldurmak' fiilinden gelir.",140],
["Pide (KÄ±ymalÄ±)",16,32,52,"atistirmalik","1590947132387-155cc02cf1ee","Pide, OsmanlÄ± dÃ¶neminde Ramazan ayÄ±nÄ±n vazgeÃ§ilmez yiyeceÄŸiydi.",260],
["Simit",11,10,79,"atistirmalik","1583338917451-face2751d8d1","Ä°stanbul'da gÃ¼nde yaklaÅŸÄ±k 2.5 milyon simit tÃ¼ketilir.",310],
["Ayran",33,28,39,"icecek","1600891964399-168dbd529d07","Ayran, probiyotik iÃ§eriÄŸi sayesinde baÄŸÄ±rsak saÄŸlÄ±ÄŸÄ±nÄ± destekler.",40],
["CacÄ±k",22,48,30,"sebze","1625398407796-cacik-similar","CacÄ±k aslÄ±nda bir Ã§orba olarak da servis edilebilir â€” yaz aylarÄ±nda soÄŸuk iÃ§ilir.",55],
["Menemen",16,52,32,"sebze","1528712306091-ed0cb7b4c71f","Menemen adÄ±nÄ± Ä°zmir'in Menemen ilÃ§esinden alÄ±r.",110],
["Sucuk",22,68,10,"et","1529042355636-sucuk-similar","Sucuk, OsmanlÄ± ordusunun temel gÄ±da maddelerinden biriydi.",350],
["PastÄ±rma",60,30,10,"et","1607623814075-5e5fa1e62109","PastÄ±rma kelimesi 'bastÄ±rma' fiilinden gelir â€” et basÄ±larak hazÄ±rlanÄ±r.",150],
["Lokum",2,3,95,"tatli","1576097449798-7c7bcb3ef9d6","Lokum 500 yÄ±lÄ± aÅŸkÄ±n bir geÃ§miÅŸe sahiptir ve 'Turkish Delight' adÄ±yla dÃ¼nyaca Ã¼nlÃ¼dÃ¼r.",370],
["KadayÄ±f",5,35,60,"tatli","1590080875515-kadayif-sim","Tel kadayÄ±f hamuru Ã¶zel bir sÃ¼zgeÃ§ten dÃ¶kÃ¼lerek yapÄ±lÄ±r.",400],
["Tulumba",4,32,64,"tatli","1590080875515-tulumba-sim","Tulumba tatlÄ±sÄ± ÅŸerbete batÄ±rÄ±lmadan Ã¶nce kÄ±zartÄ±lÄ±r â€” Ã§ift piÅŸirme tekniÄŸi uygulanÄ±r.",350],
["Åalgam",15,5,80,"icecek","1600891964092-salgam-sim","Åalgam suyu Adana'nÄ±n en meÅŸhur iÃ§eceÄŸidir ve mor havuÃ§tan yapÄ±lÄ±r.",18],
["TurÅŸu",15,3,82,"sebze","1595981235737-23ad5e04ce06","TurÅŸu suyundaki laktik asit, sindirim saÄŸlÄ±ÄŸÄ± iÃ§in faydalÄ±dÄ±r.",15],
["Ã‡iÄŸ KÃ¶fte",12,8,80,"atistirmalik","1607623814075-cigkofte-sim","AcÄ±lÄ± Ã§iÄŸ kÃ¶fte aslÄ±nda bulgur bazlÄ±dÄ±r â€” et iÃ§ermez!",165],
["Midye Dolma",28,22,50,"atistirmalik","1559339352236-midye-sim","Ä°stanbul sokaklarÄ±nda yÄ±lda tahminen 600 milyon midye dolma satÄ±lÄ±r.",135],
["KokoreÃ§",38,50,12,"et","1529042355636-kokorec-sim","KokoreÃ§, baÄŸÄ±rsak parÃ§alarÄ±nÄ±n ÅŸiÅŸe sarÄ±lÄ±p Ä±zgarada piÅŸirilmesiyle yapÄ±lÄ±r.",220],
["Tantuni",40,38,22,"et","1529042355636-tantuni-sim","Tantuni Mersin'e Ã¶zgÃ¼dÃ¼r ve Ã§ok ince kÄ±yÄ±lmÄ±ÅŸ et ile yapÄ±lÄ±r.",200],
["Adana Kebap",42,48,10,"et","1555939594046-7b3ed1a78167","Adana kebap sadece kuyruk yaÄŸÄ± ve kÄ±rmÄ±zÄ± biberle hazÄ±rlanÄ±r â€” baÅŸka baharat eklenmez.",205],
["Ä°skender Kebap",22,48,30,"et","1555939594046-iskender-sim","Ä°skender Kebap 1867'de Bursa'da Ä°skender Efendi tarafÄ±ndan icat edilmiÅŸtir.",250],
["Ali Nazik",30,42,28,"et","1555939594046-alinazik-sim","Ali Nazik, patlÄ±can ezmesi Ã¼zerine kuzu kavurma ile servis edilir.",180],
["HÃ¼nkar BeÄŸendi",18,42,40,"et","1555939594046-hunkar-sim","HÃ¼nkar BeÄŸendi'nin patlÄ±can ezmesine beÅŸamel sos eklenir.",175],
["KarnÄ±yarÄ±k",12,45,43,"sebze","1600891964092-karniyarik-sim","KarnÄ±yarÄ±k adÄ± 'karnÄ± yarÄ±k' yani ortadan kesilen patlÄ±can anlamÄ±na gelir.",150],
["Ä°mam BayÄ±ldÄ±",7,55,38,"sebze","1600891964092-imam-sim","Ä°mam BayÄ±ldÄ± efsanesine gÃ¶re imam, yemeÄŸin lezzetinden bayÄ±lmÄ±ÅŸtÄ±r.",165],
["Musakka",14,48,38,"sebze","1600891964092-musakka-sim","TÃ¼rk musakka Yunan versiyonundan farklÄ±dÄ±r â€” beÅŸamel sos kullanÄ±lmaz.",155],
["Taze Fasulye",14,30,56,"sebze","1600891964092-taze-sim","ZeytinyaÄŸlÄ± taze fasulye soÄŸuk servis edilen bir Ege klasiÄŸidir.",75],
["Bamya",12,35,53,"sebze","1600891964092-bamya-sim","BamyanÄ±n yapÄ±ÅŸkan dokusu aslÄ±nda sindirime yardÄ±mcÄ± olan bir liftir.",70],
["Kabak DolmasÄ±",10,28,62,"sebze","1600891964092-kabak-dolma-sim","Kabak dolmasÄ± hem etli hem zeytinyaÄŸlÄ± olarak iki farklÄ± ÅŸekilde yapÄ±lÄ±r.",100],
["ZeytinyaÄŸlÄ± Enginar",8,45,47,"sebze","1600891964092-enginar-sim","Enginar karaciÄŸer saÄŸlÄ±ÄŸÄ±nÄ± destekleyen gÃ¼Ã§lÃ¼ antioksidanlar iÃ§erir.",110],
["Barbunya Pilaki",18,18,64,"sebze","1600891964092-barbunya-sim","Pilaki kelimesi Rumca 'plaki' yani dÃ¼z tabak anlamÄ±na gelir.",115],
["Hamsi Tava",42,40,18,"et","1534604973900-hamsi-sim","Karadeniz'de hamsi o kadar sevilir ki ona ÅŸarkÄ±lar yazÄ±lmÄ±ÅŸtÄ±r.",185],
["Levrek Izgara",62,30,8,"et","1534604973900-levrek-sim","Levrek, omega-3 yaÄŸ asitleri aÃ§Ä±sÄ±ndan zengin bir Akdeniz balÄ±ÄŸÄ±dÄ±r.",115],
["Karides GÃ¼veÃ§",38,35,27,"et","1534604973900-karides-sim","Karides gÃ¼veÃ§, domatesli sosla gÃ¼veÃ§te piÅŸirilir ve kaÅŸar peyniri ile gratinlenir.",120],
["Kuzu TandÄ±r",32,55,13,"et","1555939594046-kuzu-sim","TandÄ±r, yerin altÄ±na gÃ¶mÃ¼len Ã¶zel fÄ±rÄ±nlarda saatlerce piÅŸirilir.",230],
["Tavuk ÅiÅŸ",52,28,20,"et","1555939594046-tavuk-sis-sim","Tavuk ÅŸiÅŸ marine edilirken yoÄŸurt kullanÄ±lmasÄ± eti yumuÅŸatÄ±r.",155],
["Ã‡oban SalatasÄ±",10,48,42,"sebze","1540420773420-coban-sim","Ã‡oban salatasÄ± TÃ¼rk kahvaltÄ±sÄ±nÄ±n ve yemeklerin vazgeÃ§ilmez yanÄ±dÄ±r.",60],
["GavurdaÄŸÄ± SalatasÄ±",8,55,37,"sebze","1540420773420-gavurdagi-sim","GavurdaÄŸÄ± salatasÄ± nar ekÅŸisi ile tatlandÄ±rÄ±lÄ±r ve ceviz eklenir.",90],
["Ezogelin Ã‡orbasÄ±",14,15,71,"corba","1547592166-0471c2609de2","Ezogelin Ã§orbasÄ± adÄ±nÄ± Gelin Ezo'nun hikayesinden alÄ±r.",80],
["Tarhana Ã‡orbasÄ±",14,18,68,"corba","1547592166-tarhana-sim","Tarhana dÃ¼nyanÄ±n ilk hazÄ±r Ã§orbasÄ± olarak kabul edilir â€” tarihi 3000 yÄ±l Ã¶ncesine dayanÄ±r.",75],
["Yayla Ã‡orbasÄ±",18,35,47,"corba","1547592166-yayla-sim","Yayla Ã§orbasÄ± yoÄŸurt bazlÄ±dÄ±r ve Ã¶zellikle Karadeniz bÃ¶lgesinde Ã§ok sevilir.",65],
["Su BÃ¶reÄŸi",13,38,49,"atistirmalik","1519864600265-su-boregi-sim","Su bÃ¶reÄŸi hamuru haÅŸlanarak hazÄ±rlanan tek bÃ¶rek Ã§eÅŸididir.",250],
["Sigara BÃ¶reÄŸi",14,45,41,"atistirmalik","1519864600265-sigara-sim","Sigara bÃ¶reÄŸi adÄ±nÄ± silindirik ÅŸeklinden alÄ±r.",290],
["GÃ¶zleme",11,28,61,"atistirmalik","1519864600265-gozleme-sim","GÃ¶zleme YÃ¶rÃ¼k Ã§adÄ±rlarÄ±nda sacda piÅŸirilen geleneksel bir hamur iÅŸidir.",220],
["Katmer",6,48,46,"tatli","1519864600265-katmer-sim","Gaziantep katmeri kaymak ve fÄ±stÄ±k ile hazÄ±rlanÄ±r â€” kahvaltÄ±da yenir.",380],
["Tahinli Pide",8,25,67,"atistirmalik","1590947132387-tahinli-sim","Tahinli pide Ã¶zellikle Ramazan ayÄ±nda Ã§ok tÃ¼ketilir.",300],
["PoÄŸaÃ§a",10,38,52,"atistirmalik","1519864600265-pogaca-sim","PoÄŸaÃ§a kelimesi Ä°talyanca 'focaccia'dan gelir.",320],
["AÃ§ma",9,32,59,"atistirmalik","1519864600265-acma-sim","AÃ§ma, yumuÅŸak dokusunu iÃ§indeki sÃ¼t ve tereyaÄŸÄ±na borÃ§ludur.",300],
["Peynirli Tepsi BÃ¶reÄŸi",14,40,46,"atistirmalik","1519864600265-tepsi-sim","Tepsi bÃ¶reÄŸi TÃ¼rk annelerinin en sÄ±k yaptÄ±ÄŸÄ± yemeklerden biridir.",270],
["HavuÃ§ Tarator",8,55,37,"sebze","1540420773420-tarator-sim","Tarator sosu ceviz veya tahin bazlÄ± olabilir.",120],
["Atom SalatasÄ±",10,35,55,"sebze","1540420773420-atom-sim","Atom salatasÄ± adÄ±nÄ± acÄ± biberlerden kaynaklanan 'patlayÄ±cÄ±' lezzetinden alÄ±r.",70],
["Haydari",20,55,25,"sebze","1540420773420-haydari-sim","Haydari sÃ¼zme yoÄŸurt ile yapÄ±lÄ±r â€” normal yoÄŸurda gÃ¶re 2 kat protein iÃ§erir.",100],
["Muhammara",7,58,35,"atistirmalik","1540420773420-muhammara-sim","Muhammara Antep mutfaÄŸÄ±ndan gelir ve kÄ±rmÄ±zÄ± biberle cevizden yapÄ±lÄ±r.",185],
["Humus",16,38,46,"atistirmalik","1547592166-humus-sim","Humus nohut bazlÄ±dÄ±r ve 7000 yÄ±llÄ±k bir geÃ§miÅŸi vardÄ±r.",175],
["Baba GannuÅŸ",8,58,34,"atistirmalik","1547592166-baba-sim","Baba gannuÅŸ kÃ¶zlenmiÅŸ patlÄ±can ve tahin ile yapÄ±lÄ±r.",130],
["Falafel",16,35,49,"atistirmalik","1547592166-falafel-sim","Falafel nohut veya bakla bazlÄ±dÄ±r ve kÄ±zartÄ±larak hazÄ±rlanÄ±r.",330],
["Ã‡Ä±lbÄ±r",30,55,15,"et","1528712306091-cilbir-sim","Ã‡Ä±lbÄ±r OsmanlÄ± saray mutfaÄŸÄ±ndan gelen yoÄŸurtlu yumurta yemeÄŸidir.",140],
["KayÄ±sÄ±",5,2,93,"atistirmalik","1560155016-kayisi","Malatya dÃ¼nya kayÄ±sÄ± Ã¼retiminin %85'ini karÅŸÄ±lar.",48],
["Ä°ncir (Taze)",4,3,93,"atistirmalik","1601379760883-incir","Ä°ncir aslÄ±nda bir meyve deÄŸil, Ã§iÃ§ektir â€” Ã§iÃ§ekleri iÃ§e doÄŸru aÃ§Ä±lÄ±r.",74],
["Nar",5,5,90,"atistirmalik","1615485290382-nar-sim","Nar antik Ã§aÄŸlardan beri bereketin simgesi olmuÅŸtur.",68],
["Dut",6,4,90,"atistirmalik","1560155016-dut-sim","Dut aÄŸacÄ± ipek bÃ¶ceklerinin tek besin kaynaÄŸÄ±dÄ±r.",43],
["Ceviz",10,73,17,"atistirmalik","1563282536-ceviz-sim","Ceviz beyin ÅŸekline benzer ve beyin saÄŸlÄ±ÄŸÄ± iÃ§in en faydalÄ± kuruyemiÅŸtir.",654],
["FÄ±ndÄ±k",9,75,16,"atistirmalik","1563282536-findik-sim","TÃ¼rkiye dÃ¼nya fÄ±ndÄ±k Ã¼retiminin %70'ini karÅŸÄ±lar.",628],
["Badem",15,72,13,"atistirmalik","1563282536-badem-sim","28g badem gÃ¼nlÃ¼k E vitamini ihtiyacÄ±nÄ±n %37'sini karÅŸÄ±lar.",579],
["Kestane",5,8,87,"atistirmalik","1563282536-kestane-sim","Kestane diÄŸer kuruyemiÅŸlerin aksine dÃ¼ÅŸÃ¼k yaÄŸlÄ± ve yÃ¼ksek karbonhidratlÄ±dÄ±r.",213],
["AÅŸure",5,8,87,"tatli","1576097449798-asure-sim","AÅŸure Nuh'un gemisi efsanesinden gelen dÃ¼nyanÄ±n en eski tatlÄ±sÄ± sayÄ±lÄ±r.",160],
["SÃ¼tlaÃ§",10,18,72,"tatli","1576097449798-sutlac-sim","FÄ±rÄ±nda sÃ¼tlaÃ§ Ã¼stÃ¼nÃ¼n karamelize olmasÄ± iÃ§in yÃ¼ksek Ä±sÄ±da piÅŸirilir.",130],
["Kazandibi",9,15,76,"tatli","1576097449798-kazandibi-sim","Kazandibi adÄ±nÄ± kazanÄ±n dibine yapÄ±ÅŸan yanÄ±k sÃ¼tten alÄ±r.",155],
["Tavuk GÃ¶ÄŸsÃ¼",9,15,76,"tatli","1576097449798-tavukgogsu-sim","Tavuk gÃ¶ÄŸsÃ¼ tatlÄ±sÄ± gerÃ§ekten tavuk eti iÃ§erir â€” OsmanlÄ± saray tatlÄ±sÄ±dÄ±r.",150],
["KeÅŸkÃ¼l",8,20,72,"tatli","1576097449798-keskul-sim","KeÅŸkÃ¼l OsmanlÄ± dÃ¶neminde derviÅŸlere daÄŸÄ±tÄ±lan bir tatlÄ±ydÄ±.",145],
["Muhallebi",8,15,77,"tatli","1576097449798-muhallebi-sim","Muhallebi adÄ± ArapÃ§a 'helbe' (sÃ¼t) kelimesinden gelir.",120],
["Kabak TatlÄ±sÄ±",3,2,95,"tatli","1576097449798-kabak-tatlisi","Kabak tatlÄ±sÄ± ÅŸeker yerine pekmez ile de yapÄ±labilir â€” daha saÄŸlÄ±klÄ± bir alternatif.",120],
["Helva (Tahin)",11,48,41,"tatli","1576097449798-helva-tahin","Tahin helvasÄ± susam bazlÄ±dÄ±r ve demir aÃ§Ä±sÄ±ndan Ã§ok zengindir.",516],
["Helva (Un)",5,30,65,"tatli","1576097449798-helva-un-sim","Un helvasÄ± cenaze sonrasÄ± ikram edilen geleneksel bir tatlÄ±dÄ±r.",370],
["Revani",5,18,77,"tatli","1576097449798-revani-sim","Revani Ä°stanbul'un fethi ÅŸerefine yapÄ±ldÄ±ÄŸÄ± rivayet edilir.",290],
["Åekerpare",5,25,70,"tatli","1576097449798-sekerpare-sim","Åekerpare hamuruna eklenen irmik, tatlÄ±ya Ã§Ä±tÄ±r doku kazandÄ±rÄ±r.",350],
["GÃ¼llaÃ§",10,8,82,"tatli","1576097449798-gullac-sim","GÃ¼llaÃ§ Ramazan'Ä±n geleneksel tatlÄ±sÄ±dÄ±r ve Ã§ok dÃ¼ÅŸÃ¼k kalorilidir.",125],
["Tavuklu Nohut",30,25,45,"et","1555939594046-tavuklu-nohut","Nohut, bitkisel protein kaynaklarÄ± arasÄ±nda en yÃ¼ksek protein oranÄ±na sahiptir.",145],
["Etli Nohut",28,30,42,"et","1555939594046-etli-nohut-sim","Etli nohut Anadolu'nun en yaygÄ±n ev yemeklerinden biridir.",160],
["Kuru KÃ¶fte",18,20,62,"et","1529042355636-kuru-kofte-sim","Kuru kÃ¶fte iÃ§indeki bulgur sayesinde liften zengindir.",200],
["Bulgur PilavÄ±",10,10,80,"sebze","1516684732162-bulgur-sim","Bulgur pirinÃ§e kÄ±yasla 4 kat daha fazla lif iÃ§erir.",110],
["Firik PilavÄ±",11,8,81,"sebze","1516684732162-firik-sim","Firik yeÅŸil buÄŸdayÄ±n yakÄ±larak iÅŸlenmesiyle elde edilir â€” eÅŸsiz bir lezzeti vardÄ±r.",115],
["LavaÅŸ",12,5,83,"atistirmalik","1519864600265-lavas-sim","LavaÅŸ UNESCO Somut Olmayan KÃ¼ltÃ¼rel Miras listesindedir.",270],
["Yufka",10,5,85,"atistirmalik","1519864600265-yufka-sim","Yufka geleneksel olarak saÃ§ Ã¼zerinde piÅŸirilir ve aylarca saklanabilir.",310],
["KaÅŸarlÄ± Tost",18,42,40,"atistirmalik","1528735602780-kasarli-tost","TÃ¼rkiye'de tostÃ§ular bir zamanlar her mahallede bulunurdu.",290],
["Kumru",16,35,49,"atistirmalik","1528735602780-kumru-sim","Kumru sandviÃ§ Ä°zmir Ã‡eÅŸme'ye Ã¶zgÃ¼dÃ¼r ve sucuk-kaÅŸar ile yapÄ±lÄ±r.",280],
["Islak Hamburger",14,32,54,"atistirmalik","1528735602780-islak-sim","Islak hamburger Taksim'in simgesidir â€” buharla Ä±sÄ±tÄ±lan Ã¶zel dolaplarda saklanÄ±r.",260],
["Midye Tava",22,35,43,"et","1534604973900-midye-tava-sim","Midye tava kÄ±zartma hamuru sayesinde Ä±slak midye dolmadan daha kalorilidir.",195],
["BalÄ±k Ekmek",20,25,55,"atistirmalik","1534604973900-balik-ekmek","EminÃ¶nÃ¼'nde balÄ±k ekmek satan tekneler Ä°stanbul'un simgesidir.",210],
["DÃ¼rÃ¼m",20,38,42,"et","1529042355636-durum-sim","DÃ¼rÃ¼m lavaÅŸÄ±n ince aÃ§Ä±lmasÄ±yla yapÄ±lÄ±r â€” kebapÃ§Ä±larda en Ã§ok tercih edilen servistir.",230],
["Beyran",38,42,20,"corba","1547592166-beyran-sim","Beyran Ã§orbasÄ± GÃ¼neydoÄŸu'da sabah kahvaltÄ±sÄ± olarak iÃ§ilir â€” Ã§ok besleyicidir.",110],
["Ä°ÅŸkembe Ã‡orbasÄ±",42,38,20,"corba","1547592166-iskembe-sim","Ä°ÅŸkembe Ã§orbasÄ± gece kulÃ¼plerinden sonra en Ã§ok tercih edilen Ã§orbadÄ±r.",52],
["PaÃ§a Ã‡orbasÄ±",35,45,20,"corba","1547592166-paca-sim","PaÃ§a Ã§orbasÄ± kolajen aÃ§Ä±sÄ±ndan zengindir ve eklem saÄŸlÄ±ÄŸÄ±nÄ± destekler.",60],
["Kelle PaÃ§a",38,48,14,"corba","1547592166-kelle-sim","Kelle paÃ§a saatlerce kaynatÄ±lÄ±r ve jÃ¶le kÄ±vamÄ±nda kolajen iÃ§erir.",70]
];

// â”€â”€ GAME STATE â”€â”€
let selectedCat = 'all';
let roundFoods = [];
let currentIdx = 0;
let totalScore = 0;
let streak = 0;
let maxStreak = 0;
let revealed = false;
let guessP = 33, guessF = 34, guessC = 33;
let isDragging = false;

// â”€â”€ CATEGORY FILTER â”€â”€
document.querySelectorAll('#catFilter .cat-btn').forEach(btn => {
 btn.addEventListener('click', () => {
  document.querySelectorAll('#catFilter .cat-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  selectedCat = btn.dataset.cat;
 });
});

// â”€â”€ TRIANGLE MATH â”€â”€
// Triangle vertices in SVG coords
const TRI = {top:{x:200,y:30}, bl:{x:35,y:325}, br:{x:365,y:325}};

function macroToXY(p, f, c) {
 // p=protein%, f=fat%, c=carb% (sum=100)
 const pp=p/100, fp=f/100, cp=c/100;
 const x = TRI.top.x*pp + TRI.bl.x*fp + TRI.br.x*cp;
 const y = TRI.top.y*pp + TRI.bl.y*fp + TRI.br.y*cp;
 return {x,y};
}

function xyToMacro(x, y) {
 // Inverse barycentric
 const {top:A, bl:B, br:C} = TRI;
 const det = (B.y-C.y)*(A.x-C.x) + (C.x-B.x)*(A.y-C.y);
 let p = ((B.y-C.y)*(x-C.x) + (C.x-B.x)*(y-C.y)) / det;
 let f = ((C.y-A.y)*(x-C.x) + (A.x-C.x)*(y-C.y)) / det;
 let c = 1 - p - f;
 // Clamp
 p = Math.max(0, Math.min(1, p));
 f = Math.max(0, Math.min(1, f));
 c = Math.max(0, Math.min(1, c));
 const s = p+f+c;
 return {p:Math.round(p/s*100), f:Math.round(f/s*100), c:Math.round(c/s*100)};
}

function isInsideTriangle(x, y) {
 const {top:A, bl:B, br:C} = TRI;
 const det = (B.y-C.y)*(A.x-C.x) + (C.x-B.x)*(A.y-C.y);
 let p = ((B.y-C.y)*(x-C.x) + (C.x-B.x)*(y-C.y)) / det;
 let f = ((C.y-A.y)*(x-C.x) + (A.x-C.x)*(y-C.y)) / det;
 let c = 1 - p - f;
 return p >= -0.02 && f >= -0.02 && c >= -0.02;
}

// â”€â”€ TRIANGLE INTERACTION â”€â”€
const svg = document.getElementById('triSvg');
const guessDot = document.getElementById('guessDot');

function svgPoint(e) {
 const rect = svg.getBoundingClientRect();
 const clientX = e.touches ? e.touches[0].clientX : e.clientX;
 const clientY = e.touches ? e.touches[0].clientY : e.clientY;
 const scaleX = 400 / rect.width;
 const scaleY = 370 / rect.height;
 return {x: (clientX - rect.left) * scaleX, y: (clientY - rect.top) * scaleY};
}

function moveGuess(x, y) {
 if (revealed) return;
 if (!isInsideTriangle(x, y)) return;
 guessDot.setAttribute('cx', x);
 guessDot.setAttribute('cy', y);
 const m = xyToMacro(x, y);
 guessP = m.p; guessF = m.f; guessC = m.c;
 // Fix rounding
 const diff = 100 - (guessP + guessF + guessC);
 guessC += diff;
 updateSliders();
}

svg.addEventListener('mousedown', e => { if(!revealed){isDragging=true; moveGuess(...Object.values(svgPoint(e)))} });
svg.addEventListener('mousemove', e => { if(isDragging) moveGuess(...Object.values(svgPoint(e))) });
document.addEventListener('mouseup', () => isDragging=false);
svg.addEventListener('touchstart', e => { if(!revealed){isDragging=true; e.preventDefault(); moveGuess(...Object.values(svgPoint(e)))} }, {passive:false});
svg.addEventListener('touchmove', e => { if(isDragging){e.preventDefault(); moveGuess(...Object.values(svgPoint(e)))} }, {passive:false});
svg.addEventListener('touchend', () => isDragging=false);

// â”€â”€ SLIDERS â”€â”€
const sP = document.getElementById('sProtein');
const sF = document.getElementById('sFat');
const sC = document.getElementById('sCarb');

function updateSliders() {
 sP.value = guessP; sF.value = guessF; sC.value = guessC;
 document.getElementById('vProtein').textContent = guessP + '%';
 document.getElementById('vFat').textContent = guessF + '%';
 document.getElementById('vCarb').textContent = guessC + '%';
}

function onSliderChange(which) {
 if (revealed) return;
 let p = +sP.value, f = +sF.value, c = +sC.value;
 const total = p + f + c;
 if (total !== 100) {
  const excess = total - 100;
  if (which === 'p') { const r = f+c||1; f = Math.max(0,Math.round(f - excess*f/r)); c = 100-p-f; }
  else if (which === 'f') { const r = p+c||1; p = Math.max(0,Math.round(p - excess*p/r)); c = 100-p-f; }
  else { const r = p+f||1; p = Math.max(0,Math.round(p - excess*p/r)); f = 100-p-c; }
  p = Math.max(0, p); f = Math.max(0, f); c = Math.max(0, c);
 }
 guessP=p; guessF=f; guessC=c;
 updateSliders();
 // Move dot
 const pos = macroToXY(guessP, guessF, guessC);
 guessDot.setAttribute('cx', pos.x);
 guessDot.setAttribute('cy', pos.y);
}

sP.addEventListener('input', () => onSliderChange('p'));
sF.addEventListener('input', () => onSliderChange('f'));
sC.addEventListener('input', () => onSliderChange('c'));

// â”€â”€ DRAW GRID â”€â”€
function drawGrid() {
 const g = document.getElementById('triGrid');
 let lines = '';
 for (let i = 1; i < 10; i++) {
  const t = i/10;
  // Lines parallel to each side
  const p1 = {x:TRI.top.x+(TRI.bl.x-TRI.top.x)*t, y:TRI.top.y+(TRI.bl.y-TRI.top.y)*t};
  const p2 = {x:TRI.top.x+(TRI.br.x-TRI.top.x)*t, y:TRI.top.y+(TRI.br.y-TRI.top.y)*t};
  lines += `<line x1="${p1.x}" y1="${p1.y}" x2="${p2.x}" y2="${p2.y}"/>`;
  const p3 = {x:TRI.bl.x+(TRI.top.x-TRI.bl.x)*t, y:TRI.bl.y+(TRI.top.y-TRI.bl.y)*t};
  const p4 = {x:TRI.bl.x+(TRI.br.x-TRI.bl.x)*t, y:TRI.bl.y+(TRI.br.y-TRI.bl.y)*t};
  lines += `<line x1="${p3.x}" y1="${p3.y}" x2="${p4.x}" y2="${p4.y}"/>`;
  const p5 = {x:TRI.br.x+(TRI.top.x-TRI.br.x)*t, y:TRI.br.y+(TRI.top.y-TRI.br.y)*t};
  const p6 = {x:TRI.br.x+(TRI.bl.x-TRI.br.x)*t, y:TRI.br.y+(TRI.bl.y-TRI.br.y)*t};
  lines += `<line x1="${p5.x}" y1="${p5.y}" x2="${p6.x}" y2="${p6.y}"/>`;
 }
 g.innerHTML = lines;
}
drawGrid();

// â”€â”€ UNSPLASH PHOTOS â”€â”€
// Use category-based fallback photos that reliably exist
function getFoodPhoto(food) {
 const catPhotos = {
  'corba': 'https://images.unsplash.com/photo-1547592166-23ac45744acd?w=400&h=300&fit=crop',
  'et': 'https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=400&h=300&fit=crop',
  'sebze': 'https://images.unsplash.com/photo-1540420773420-3366772f4999?w=400&h=300&fit=crop',
  'tatli': 'https://images.unsplash.com/photo-1576097449798-7c7bcb3ef2d6?w=400&h=300&fit=crop',
  'atistirmalik': 'https://images.unsplash.com/photo-1529042355636-9d2a2d3e3894?w=400&h=300&fit=crop',
  'icecek': 'https://images.unsplash.com/photo-1600891964092-4316c8e21d2a?w=400&h=300&fit=crop'
 };
 // Specific photos for popular items
 const specific = {
  'Baklava': 'https://images.unsplash.com/photo-1519676867240-f03562e64548?w=400&h=300&fit=crop',
  'Simit': 'https://images.unsplash.com/photo-1583338917451-face2751d8d1?w=400&h=300&fit=crop',
  'Adana Kebap': 'https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=400&h=300&fit=crop',
  'KÃ¶fte (Izgara)': 'https://images.unsplash.com/photo-1529042355636-9d2a2d3e3894?w=400&h=300&fit=crop',
  'Humus': 'https://images.unsplash.com/photo-1547592166-23ac45744acd?w=400&h=300&fit=crop',
  'Menemen': 'https://images.unsplash.com/photo-1528712306091-ed0cb7b4c71f?w=400&h=300&fit=crop',
  'Pilav (PirinÃ§)': 'https://images.unsplash.com/photo-1516684732162-798a0062be99?w=400&h=300&fit=crop',
  'Mercimek Ã‡orbasÄ±': 'https://images.unsplash.com/photo-1547592166-23ac45744acd?w=400&h=300&fit=crop',
  'Lokum': 'https://images.unsplash.com/photo-1576097449798-7c7bcb3ef2d6?w=400&h=300&fit=crop',
  'Ceviz': 'https://images.unsplash.com/photo-1563282536-4a1e7d5a281a?w=400&h=300&fit=crop',
  'FÄ±ndÄ±k': 'https://images.unsplash.com/photo-1563282536-4a1e7d5a281a?w=400&h=300&fit=crop',
  'Badem': 'https://images.unsplash.com/photo-1563282536-4a1e7d5a281a?w=400&h=300&fit=crop',
  'Falafel': 'https://images.unsplash.com/photo-1547592166-23ac45744acd?w=400&h=300&fit=crop',
  'Ã‡oban SalatasÄ±': 'https://images.unsplash.com/photo-1540420773420-3366772f4999?w=400&h=300&fit=crop',
  'Ä°ncir (Taze)': 'https://images.unsplash.com/photo-1601379760883-1bb497c558e0?w=400&h=300&fit=crop',
  'Nar': 'https://images.unsplash.com/photo-1615485290382-441e4d049cb5?w=400&h=300&fit=crop'
 };
 if (specific[food[0]]) return specific[food[0]];
 return catPhotos[food[4]] || catPhotos['atistirmalik'];
}

const catNames = {corba:'ğŸ² Ã‡orba', et:'ğŸ¥© Et', sebze:'ğŸ¥¬ Sebze', tatli:'ğŸ° TatlÄ±', atistirmalik:'ğŸ¥™ AtÄ±ÅŸtÄ±rmalÄ±k', icecek:'ğŸ¥¤ Ä°Ã§ecek'};

// â”€â”€ GAME LOGIC â”€â”€
function startGame() {
 let pool = selectedCat === 'all' ? [...FOODS] : FOODS.filter(f => f[4] === selectedCat);
 if (pool.length < 10) pool = [...FOODS]; // fallback
 // Shuffle & pick 10
 for (let i = pool.length - 1; i > 0; i--) { const j = Math.floor(Math.random()*(i+1)); [pool[i],pool[j]]=[pool[j],pool[i]]; }
 roundFoods = pool.slice(0, 10);
 currentIdx = 0; totalScore = 0; streak = 0; maxStreak = 0;
 showScreen('game');
 loadFood();
}

function showScreen(s) {
 document.getElementById('startScreen').classList.toggle('active', s==='start');
 document.getElementById('gameScreen').classList.toggle('active', s==='game');
 document.getElementById('endScreen').classList.toggle('active', s==='end');
}

function loadFood() {
 const f = roundFoods[currentIdx];
 revealed = false;
 document.getElementById('foodImg').src = getFoodPhoto(f);
 document.getElementById('foodImg').alt = f[0];
 document.getElementById('foodName').textContent = f[0];
 document.getElementById('foodPortion').textContent = `100g baÅŸÄ±na Â· ${f[7]} kcal`;
 document.getElementById('foodCategory').textContent = catNames[f[4]] || f[4];
 document.getElementById('progressFill').style.width = ((currentIdx)/10*100) + '%';
 document.getElementById('progressText').textContent = `${currentIdx+1} / 10`;
 document.getElementById('totalScore').textContent = totalScore;
 document.getElementById('streak').textContent = streak;

 // Reset
 guessP=33; guessF=34; guessC=33;
 updateSliders();
 const pos = macroToXY(33,34,33);
 guessDot.setAttribute('cx', pos.x); guessDot.setAttribute('cy', pos.y);
 guessDot.style.opacity = '1';
 document.getElementById('answerDot').style.opacity = '0';
 document.getElementById('diffLine').style.opacity = '0';
 document.getElementById('resultOverlay').classList.remove('show');
 document.getElementById('guessArea').style.display = '';
 document.getElementById('slidersArea').style.pointerEvents = '';
 document.getElementById('slidersArea').style.opacity = '';
 window.scrollTo({top:0, behavior:'smooth'});
}

function revealAnswer() {
 if (revealed) return;
 revealed = true;
 const f = roundFoods[currentIdx];
 const realP = f[1], realF = f[2], realC = f[3];

 // Calculate score (100 - avg absolute deviation * 2, min 0)
 const diff = (Math.abs(guessP-realP) + Math.abs(guessF-realF) + Math.abs(guessC-realC)) / 2;
 const score = Math.max(0, Math.round(100 - diff));

 totalScore += score;
 if (score >= 70) { streak++; maxStreak = Math.max(maxStreak, streak); } else { streak = 0; }

 document.getElementById('totalScore').textContent = totalScore;
 document.getElementById('streak').textContent = streak;

 // Animate answer dot
 const ansPos = macroToXY(realP, realF, realC);
 const ansDot = document.getElementById('answerDot');
 ansDot.setAttribute('cx', ansPos.x);
 ansDot.setAttribute('cy', ansPos.y);
 setTimeout(() => { ansDot.style.opacity = '1'; }, 200);

 // Diff line
 const dl = document.getElementById('diffLine');
 dl.setAttribute('x1', guessDot.getAttribute('cx'));
 dl.setAttribute('y1', guessDot.getAttribute('cy'));
 dl.setAttribute('x2', ansPos.x);
 dl.setAttribute('y2', ansPos.y);
 setTimeout(() => { dl.style.opacity = '0.5'; }, 400);

 // Disable sliders
 document.getElementById('slidersArea').style.pointerEvents = 'none';
 document.getElementById('slidersArea').style.opacity = '0.5';
 document.getElementById('guessArea').style.display = 'none';

 // Show results
 const colors = {p:'var(--protein)', f:'var(--fat)', c:'var(--carb)'};
 const makeRow = (label, val, color) => `<div class="val-row"><span style="display:flex;align-items:center"><span class="dot" style="background:${color}"></span>${label}</span><strong>${val}%</strong></div>`;
 document.getElementById('guessVals').innerHTML = makeRow('Protein',guessP,colors.p)+makeRow('YaÄŸ',guessF,colors.f)+makeRow('Karb.',guessC,colors.c);
 document.getElementById('realVals').innerHTML = makeRow('Protein',realP,colors.p)+makeRow('YaÄŸ',realF,colors.f)+makeRow('Karb.',realC,colors.c);

 const scoreEl = document.getElementById('roundScore');
 scoreEl.textContent = score;
 scoreEl.style.color = score >= 80 ? 'var(--carb)' : score >= 50 ? 'var(--accent)' : 'var(--fat)';

 document.getElementById('funFact').innerHTML = `<strong>ğŸ’¡ Bunu Biliyor Muydunuz?</strong> ${f[6]}`;
 document.getElementById('nextBtn').textContent = currentIdx < 9 ? 'Sonraki â†’' : 'SonuÃ§larÄ± GÃ¶r ğŸ†';

 document.getElementById('resultOverlay').classList.add('show');
 document.getElementById('progressFill').style.width = ((currentIdx+1)/10*100) + '%';
}

function nextFood() {
 currentIdx++;
 if (currentIdx >= 10) { endGame(); return; }
 loadFood();
}

function endGame() {
 document.getElementById('finalScore').textContent = totalScore;
 document.getElementById('finalStreak').innerHTML = `ğŸ”¥ En uzun seri: ${maxStreak}`;
 const avg = totalScore / 10;
 let msg = '';
 if (avg >= 85) msg = 'MuhteÅŸem! Bir beslenme uzmanÄ± gibi biliyorsun! ğŸŒŸ';
 else if (avg >= 70) msg = 'Harika! Makro bilgin Ã§ok iyi seviyede! ğŸ’ª';
 else if (avg >= 50) msg = 'Fena deÄŸil! Biraz pratikle daha da iyi olabilirsin. ğŸ‘';
 else msg = 'TÃ¼rk mutfaÄŸÄ±nÄ±n makro sÃ¼rprizleri seni ÅŸaÅŸÄ±rttÄ±! Tekrar dene! ğŸ¯';
 document.getElementById('endMsg').textContent = msg;
 const shareMsg = `ğŸ”º Makro ÃœÃ§geni'nde 1000 Ã¼zerinden ${totalScore} puan aldÄ±m!\nğŸ”¥ En uzun seri: ${maxStreak}\n\nSen de dene: uzunyasa.com/pages/araclar/makro-ucgeni.html`;
 document.getElementById('shareText').textContent = shareMsg;
 showScreen('end');
}

function shareResult() {
 const text = document.getElementById('shareText').textContent;
 if (navigator.share) {
  navigator.share({text}).catch(()=>{});
 } else if (navigator.clipboard) {
  navigator.clipboard.writeText(text).then(() => {
   const btn = event.target;
   btn.textContent = 'âœ… KopyalandÄ±!';
   setTimeout(() => btn.textContent = 'ğŸ“‹ Kopyala & PaylaÅŸ', 2000);
  });
 }
}
</script>
</body>
</html>
